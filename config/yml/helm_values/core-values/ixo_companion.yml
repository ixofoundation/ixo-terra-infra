image:
  pullPolicy: Always
ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-staging
    # SSE/Streaming support
    nginx.ingress.kubernetes.io/proxy-buffering: "off"
    nginx.ingress.kubernetes.io/proxy-request-buffering: "off"
    nginx.ingress.kubernetes.io/proxy-http-version: "1.1"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"
  tls:
    - hosts:
        - ${host}
      secretName: ixo-companion-tls
  hosts:
    - host: ${host}
      paths:
        - path: /
          pathType: Prefix
service:
  port: 3000
env:
  - name: "PORT"
    value: "3000"
  - name: CHROMA_URL
    value: "http://chromadb.chromadb.svc.cluster.local:8000"
  - name: "ORACLE_NAME"
    value: "<path:${vault_mount}/data/ixo-companion#ORACLE_NAME>"
  - name: "MATRIX_BASE_URL"
    value: "<path:${vault_mount}/data/ixo-companion#MATRIX_BASE_URL>"
  - name: "MATRIX_ORACLE_ADMIN_PASSWORD"
    value: "<path:${vault_mount}/data/ixo-companion#MATRIX_ORACLE_ADMIN_PASSWORD>"
  - name: "MATRIX_ORACLE_ADMIN_ACCESS_TOKEN"
    value: "<path:${vault_mount}/data/ixo-companion#MATRIX_ORACLE_ADMIN_ACCESS_TOKEN>"
  - name: "MATRIX_ORACLE_ADMIN_USER_ID"
    value: "<path:${vault_mount}/data/ixo-companion#MATRIX_ORACLE_ADMIN_USER_ID>"
  - name: "MATRIX_RECOVERY_PHRASE"
    value: "<path:${vault_mount}/data/ixo-companion#MATRIX_RECOVERY_PHRASE>"
  - name: "OPENAI_API_KEY"
    value: "<path:${vault_mount}/data/ixo-companion#OPENAI_API_KEY>"
  - name: "LANGFUSE_PUBLIC_KEY"
    value: "<path:${vault_mount}/data/ixo-companion#LANGFUSE_PUBLIC_KEY>"
  - name: "LANGFUSE_SECRET_KEY"
    value: "<path:${vault_mount}/data/ixo-companion#LANGFUSE_SECRET_KEY>"
  - name: "LANGFUSE_HOST"
    value: "<path:${vault_mount}/data/ixo-companion#LANGFUSE_HOST>"
  - name: "OPEN_ROUTER_API_KEY"
    value: "<path:${vault_mount}/data/ixo-companion#OPEN_ROUTER_API_KEY>"
  - name: "OPEN_ROUTER_BASE_URL"
    value: "<path:${vault_mount}/data/ixo-companion#OPEN_ROUTER_BASE_URL>"
  - name: "MEMORY_MCP_API"
    value: "<path:${vault_mount}/data/ixo-companion#MEMORY_MCP_API>"
  - name: "MEMORY_MCP_URL"
    value: "<path:${vault_mount}/data/ixo-companion#MEMORY_MCP_URL>"
  - name: "RPC_URL"
    value: "<path:${vault_mount}/data/ixo-companion#RPC_URL>"
  - name: "BLOCKSYNC_GRAPHQL_URL"
    value: "<path:${vault_mount}/data/ixo-companion#BLOCKSYNC_GRAPHQL_URL>"
  - name: "ORACLE_ENTITY_DID"
    value: "<path:${vault_mount}/data/ixo-companion#ORACLE_ENTITY_DID>"
  - name: "MEMORY_ENGINE_URL"
    value: "<path:${vault_mount}/data/ixo-companion#MEMORY_ENGINE_URL>"
  - name: "MEMORY_SERVICE_API_KEY"
    value: "<path:${vault_mount}/data/ixo-companion#MEMORY_SERVICE_API_KEY>"
  - name: "SUBSCRIPTION_URL"
    value: "<path:${vault_mount}/data/ixo-companion#SUBSCRIPTION_URL>"
  - name: "FIRECRAWL_MCP_URL"
    value: ${firecrawl_mcp_url}
  - name: "DOMAIN_INDEXER_URL"
    value: "http://ixo-domain-indexer.core.svc.cluster.local:8080"
  - name: "NODE_ENV"
    value: "production"
  - name: "NETWORK"
    value: "<path:${vault_mount}/data/ixo-companion#NETWORK>"
  - name: "SECP_MNEMONIC"
    value: "<path:${vault_mount}/data/ixo-companion#SECP_MNEMONIC>"
  - name: "REDIS_URL"
    value: "<path:${vault_mount}/data/ixo-companion#REDIS_URL>"
  - name: "FIRECRAWL_MCP_URL"
    value: "<path:${vault_mount}/data/ixo-companion#FIRECRAWL_MCP_URL>"
  - name: "DOMAIN_INDEXER_URL"
    value: "<path:${vault_mount}/data/ixo-companion#DOMAIN_INDEXER_URL>"
  - name: "MATRIX_VALUE_PIN"
    value: "<path:${vault_mount}/data/ixo-companion#MATRIX_VALUE_PIN>"
  - name: "THROW_ON_INSUFFICIENT_CREDITS"
    value: "<path:${vault_mount}/data/ixo-companion#THROW_ON_INSUFFICIENT_CREDITS>"
  - name: "DISABLE_CREDITS"
    value: "<path:${vault_mount}/data/ixo-companion#DISABLE_CREDITS>"
resources:
  requests:
    memory: 1024Mi
    cpu: "40m"
  limits:
    memory: 1100Mi
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 1
  targetMemoryUtilizationPercentage: "30"